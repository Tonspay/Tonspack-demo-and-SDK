class Tonspack{constructor(o,t){if(o){this.uuid=o}else{this.uuid=crypto.randomUUID()}if(t?.baseurl){this.baseurl=t.baseurl}else{this.baseurl="https://pack.tons.ink/api"}if(t?.actionUrl){this.actionUrl=t.actionUrl}else{this.actionUrl="https://t.me/tonspack_bot/connect?startapp="}if(t?.loopInterval){this.loopInterval=t.loopInterval}else{this.loopInterval=500}if(t?.loopTimeout){this.loopTimeout=t.loopTimeout}else{this.loopTimeout=120}}async loopCheck(){for(var o=0;o<this.loopTimeout;o++){const t=await this.check_request_action();if(t.data){return t.data}await this.sleep(this.loopInterval)}return{status:false,reason:"user operation timeout"}}async sleep(t){return new Promise(o=>{setTimeout(o,t)})}async check_request_action(){try{return(await fetch(this.baseurl+"/result/"+this.uuid,{method:"GET",headers:{},redirect:"follow"})).json()}catch(o){console.error(o);return false}}async connect(o,t){const e=window.location.origin;const n={t:0,i:this.uuid,d:e,c:o,r:t||null};window.open(this.actionUrl+base58.encode(Buffer.from(JSON.stringify(n))),"newwindow","height=800, width=400, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no");return await this.loopCheck()}async sign(o,t,e){const n={t:1,i:this.uuid,d:t,c:o,r:e||null};window.open(this.actionUrl+base58.encode(Buffer.from(JSON.stringify(n))),"newwindow","height=800, width=400, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no");return await this.loopCheck()}async send(o,t,e){const n={t:2,i:this.uuid,d:t,c:o,r:e||null};window.open(this.actionUrl+base58.encode(Buffer.from(JSON.stringify(n))),"newwindow","height=800, width=400, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no");return await this.loopCheck()}}